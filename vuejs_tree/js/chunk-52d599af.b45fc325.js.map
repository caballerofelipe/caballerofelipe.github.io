{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.string.starts-with.js","webpack:///./src/components/subTree.vue?94b5","webpack:///./src/components/subTree.vue?d101","webpack:///src/components/subTree.vue","webpack:///./src/components/subTree.vue?c53a","webpack:///./src/components/subTree.vue?988e"],"names":["$","getOwnPropertyDescriptor","f","toLength","notARegExp","requireObjectCoercible","correctIsRegExpLogic","IS_PURE","nativeStartsWith","startsWith","min","Math","CORRECT_IS_REGEXP_LOGIC","MDN_POLYFILL_BUG","descriptor","String","prototype","writable","target","proto","forced","searchString","that","this","index","arguments","length","undefined","search","call","slice","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","$event","stopPropagation","nodeAndSubTree_dragstart","preventDefault","nodeAndSubTree_dragend","node_dragenter","node_remove","_v","_s","node","nodeValue","staticStyle","id","originalID","processTree","staticRenderFns","component"],"mappings":"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","file":"js/chunk-52d599af.b45fc325.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\nvar nativeStartsWith = ''.startsWith;\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.startsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.startswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = String(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return nativeStartsWith\n      ? nativeStartsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./subTree.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./subTree.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"subTree\"},[_c('div',{staticClass:\"nodeAndSubTree\",attrs:{\"draggable\":\"true\"},on:{\"dragstart\":function($event){$event.stopPropagation();return _vm.nodeAndSubTree_dragstart($event)},\"dragend\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.nodeAndSubTree_dragend($event)}}},[_c('div',{staticClass:\"node\",on:{\"dragenter\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.node_dragenter($event)}}},[_c('div',{staticClass:\"nodeRemove\",on:{\"click\":_vm.node_remove}},[_vm._v(\"X\")]),_vm._v(\" \"+_vm._s(_vm.node.nodeValue)),_c('div',{staticStyle:{\"font-size\":\"8px\",\"color\":\"lightgreen\"}},[_vm._v(\" (id: \"),_c('b',[_vm._v(_vm._s(_vm.node.id))]),_c('br'),_vm._v(\"initial:\"),_c('br'),_c('b',[_vm._v(_vm._s(_vm.node.originalID))]),_vm._v(\") \")])]),_c('subTreesRow',{attrs:{\"subTreesRow\":_vm.node.processTree}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div class=\"subTree\">\n    <div class=\"nodeAndSubTree\" draggable=\"true\" @dragstart.stop='nodeAndSubTree_dragstart' @dragend.stop.prevent='nodeAndSubTree_dragend'>\n        <div class=\"node\" @dragenter.prevent.stop='node_dragenter'>\n            <div class=\"nodeRemove\" @click=\"node_remove\">X</div>\n            {{node.nodeValue}}<!-- FCG to keep text inside, should be max 33 char -->\n            <div style=\"font-size: 8px; color: lightgreen;\">\n                <!-- DEBUG -->\n                (id: <b>{{node.id}}</b><br>initial:<br><b>{{node.originalID}}</b>)\n            </div>\n        </div>\n        <!-- subTreesRow should always be created as it's used to insert the drop placeholder. -->\n        <subTreesRow v-bind:subTreesRow='node.processTree' />\n    </div>\n</div>\n</template>\n\n<script>\nimport subTreesRow from '@/components/subTreesRow.vue';\nimport eventsBus from '@/lib/eventsBus.js';\n\nexport default {\n    name: 'subTree',\n    components: {\n        subTreesRow\n    },\n    props: [\n        'node'\n    ],\n    computed: {},\n    methods: {\n        nodeAndSubTree_dragstart(event) {\n            eventsBus.setEventData('node', 'movement', {\n                id: this.node.id\n            });\n            event.target.style.opacity = 0.2; // Inadvertently: this solves the issue with the hierarchy lines\n        },\n        nodeAndSubTree_dragend(event) {\n            event.target.style.opacity = 1;\n            document.querySelectorAll('.dnd_placeholder').forEach((e) => e.remove());\n            eventsBus.getEventData(true);\n        },\n        node_dragenter() {\n            // Basic validations\n            if (this == null || !this.node || !this.node.id) {\n                return\n            }\n            let eventData = eventsBus.getEventData(false);\n\n            // If not a node event\n            if (!eventData || eventData.element != 'node') {\n                return;\n            }\n\n            // If entering dragged element remove placeholders\n            if (eventData.eventType == 'movement' && eventData.payload &&\n                this.node.id.startsWith(eventData.payload.id) // The dragged over element is itself or a child\n            ) {\n                let newEventData = eventsBus.getEventData(true);\n                let newMetadata = { ...newEventData.metadata,\n                    ...{\n                        currentHoveredSubTree: null\n                    }\n                };\n                eventsBus.setEventData(newEventData.element, newEventData.eventType, newEventData.payload, newMetadata);\n                document.querySelectorAll('.dnd_placeholder').forEach((e) => e.remove());\n                return;\n            }\n            let hoveredSubTree = this.$el;\n\n            // Avoid redoing work and creating an infinite loop of adding/removing/adding/...\n            if (eventData && eventData.metadata && eventData.metadata.currentHoveredSubTree == hoveredSubTree) {\n                return;\n            }\n\n            // Reset currentHoveredSubTree\n            let newEventData = eventsBus.getEventData(true);\n            let newMetadata = { ...newEventData.metadata,\n                ...{\n                    currentHoveredSubTree: hoveredSubTree\n                }\n            };\n            eventsBus.setEventData(newEventData.element, newEventData.eventType, newEventData.payload, newMetadata);\n            document.querySelectorAll('.dnd_placeholder').forEach((e) => e.remove());\n\n            let newdivs = [];\n            let elementToAdd = document.createElement('div');\n\n            elementToAdd.className = 'subTree dnd_placeholder';\n            elementToAdd.innerHTML = '<div class=\"nodeAndSubTree\"><div class=\"node\">Drop</div></div>';\n\n            newdivs[0] = elementToAdd.cloneNode(true);\n            newdivs[0].action = 'before';\n            newdivs[1] = elementToAdd.cloneNode(true);\n            newdivs[1].action = 'after';\n            newdivs[2] = elementToAdd.cloneNode(true);\n            newdivs[2].action = 'below';\n            let dropOnElements = [];\n            let dropOnElements_before = hoveredSubTree.parentNode.insertBefore(newdivs[0], hoveredSubTree);\n            dropOnElements.push(dropOnElements_before);\n            let dropOnElements_after = hoveredSubTree.parentNode.insertBefore(newdivs[1], hoveredSubTree.nextSibling);\n            dropOnElements.push(dropOnElements_after);\n            // If the hovered element doesn't have any child\n            if (this.node.processTree.length == 0) {\n                let dropOnElements_below = hoveredSubTree.querySelector('.subTreesRow').appendChild(newdivs[2])\n                dropOnElements.push(dropOnElements_below);\n            }\n            let that = this;\n            dropOnElements.forEach(element => {\n                let placeHolderNode = element.querySelector('.node');\n                placeHolderNode.addEventListener('dragover', function(event) {\n                    event.target.style.background = 'lightgreen';\n                    event.preventDefault();\n                    event.stopPropagation();\n                }, false);\n                placeHolderNode.addEventListener('dragleave', function(event) {\n                    event.target.style.background = 'lightgray';\n                    event.preventDefault();\n                    event.stopPropagation();\n                }, false);\n                placeHolderNode.addEventListener('drop', function(event) {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    document.querySelectorAll('.dnd_placeholder').forEach((e) => e.remove());\n                    let eventData = eventsBus.getEventData(true);\n                    if (eventData.element == 'node') {\n                        switch (eventData.eventType) {\n                            case 'movement':\n                                that.$store.commit({\n                                    type: 'moveNodeNextToNode',\n                                    movedNodePathStr: eventData.payload.id,\n                                    nextToNodePathStr: that.node.id,\n                                    position: element.action\n                                });\n                                break;\n                            case 'creation':\n                                that.$store.commit({\n                                    type: 'createNodeNextToNode',\n                                    nextToNodePathStr: that.node.id,\n                                    position: element.action\n                                });\n                                break;\n                            default:\n                                break;\n                        }\n                    }\n                }, false);\n            })\n        },\n        node_remove() {\n            this.$store.commit({\n                type: 'removeNode',\n                nodePathStr: this.node.id\n            });\n        }\n    },\n    mounted() {}\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/sass/config.scss';\n\n.subTree {\n    // For tree creation.\n    display: inline-block;\n    vertical-align: top;\n\n    // To show hierarchy lines.\n    // To create hierarchy lines, these are the lines from element to horizontal connecting line and the vertical connecting line.\n    position: relative;\n    &:after,\n    &:before {\n        content: '';\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 50%;\n        height: $node_padding;\n    }\n    &:after {\n        left: calc(50% - #{$hierarchy_line_width/2});\n        border-left: $hierarchy_line_width solid $hierarchy_line_color;\n    }\n    &:not(:first-child):before,\n    &:not(:last-child):after {\n        border-top: $hierarchy_line_width solid $hierarchy_line_color;\n        height: calc(#{$node_padding} - #{$hierarchy_line_width}); // To avoid having the line on top of the node.\n    }\n    &:last-child:after {\n        width: 0; // Necessary to avoid subTreesRow horizontal scrolling.\n    }\n}\n\n.nodeAndSubTree {\n    padding: $node_padding;\n}\n.node {\n    background-color: #8284d2;\n    color: white;\n    border-radius: 100%;\n    width: $node_width;\n    height: $node_height;\n    padding: 5px;\n    white-space: normal;\n    word-wrap: break-word;\n    cursor: move;\n    position: relative;\n\n    // To center bubble and content.\n    display: inline-flex;\n    flex-direction: column;\n    justify-content: center;\n}\n.nodeRemove {\n    background: #8284d2aa;\n    color: white;\n    border-radius: 100%;\n    width: 10px;\n    height: 10px;\n    padding: 5px;\n    white-space: normal;\n    word-wrap: break-word;\n    position: absolute;\n    top: 0;\n    right: 0;\n    cursor: default;\n    border: 1px solid #ffffffaa;\n\n    // To center bubble and content.\n    display: inline-flex;\n    flex-direction: column;\n    justify-content: center;\n\n    &:hover {\n        background: #8284d2dd;\n        border: 1px solid #ffffffdd;\n    }\n}\n\n.dnd_placeholder {\n    .node {\n        color: #333;\n        background-color: lightgray;\n    }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./subTree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./subTree.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./subTree.vue?vue&type=template&id=fdf1f25c&\"\nimport script from \"./subTree.vue?vue&type=script&lang=js&\"\nexport * from \"./subTree.vue?vue&type=script&lang=js&\"\nimport style0 from \"./subTree.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}